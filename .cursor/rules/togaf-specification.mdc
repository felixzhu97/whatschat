# TOGAF Specification

## Core Concepts

TOGAF (The Open Group Architecture Framework) is a standard framework for enterprise
architecture development. It consists of:

1. **ADM** (Architecture Development Method) – the method for developing architectures
2. **Four architecture domains** – Business, Application, Data, Technology
3. **Architecture content framework** – standard structure for architecture deliverables
4. **Architecture capability framework** – capabilities for governing enterprise architecture

## Four Architecture Domains

### Business Architecture

**Definition** – describes business processes, organization structure, business capabilities,
and value streams.

**In this project**:

- Capabilities: user management, instant messaging, voice & video calls, file sharing,
  group management, contact management, notification management, status sharing
- Processes: user registration/login, send message, start call, create group,
  share status, upload file, add contact

**Diagram** – `docs/architecture/togaf/business-architecture.puml`

### Application Architecture

**Definition** – describes the structure of application systems, components, interfaces,
and their interactions.

**In this project**:

- Client applications layer: Web app (Next.js 15, React 19), mobile app (React Native, Expo)
- API gateway layer: REST API gateway, WebSocket gateway, WebRTC signaling
- Application services layer: auth, user, message, chat, call, group, status, file,
  and notification services
- Business logic layer: message handling, realtime communication, authorization,
  business rules engine
- Data access layer: data repository, cache service
- Infrastructure services: PostgreSQL, Redis, file storage, search service

**Diagram** – `docs/architecture/togaf/application-architecture.puml`

**Code mapping**:

- `apps/web/` – Web application (app, domain, application, infrastructure, presentation)
- `apps/mobile/` – mobile application (same layered structure)
- `apps/server/` – backend services (domain, application, infrastructure, presentation)

### Data Architecture

**Definition** – describes data structures, data flows, data storage, and data management.

**In this project**:

- Data entities: User, Chat, Message, Group, Call, Status, Contact, Notification, FileUpload
- Association entities: ChatParticipant, GroupParticipant, CallParticipant,
  MessageRead, MessageReaction, StatusView, UserSettings, BlockedUser
- Data storage: PostgreSQL primary database, Redis cache & session store,
  MinIO/S3 file storage
- Data flows: write flows, read flows, realtime flows (Redis Pub/Sub + WebSocket)

**Diagram** – `docs/architecture/togaf/data-architecture.puml`

**Code mapping**:

- `apps/server/prisma/` – schema definitions and migrations
- `apps/server/src/` – data access and caching logic (infrastructure, application layers)

### Technology Architecture

**Definition** – describes technology platforms, infrastructure, technology standards,
and deployment architecture.

**In this project**:

- Client stack: Web (Next.js 15, React 19, TypeScript, Tailwind CSS, Zustand, WebSocket, WebRTC),
  Mobile (React Native, Expo, TypeScript, Zustand)
- Application server: NestJS 10, Express, Node.js, REST API, Socket.IO, WebRTC signaling,
  JWT, Passport, bcrypt, Helmet, CORS
- Data persistence: PostgreSQL 13+, Prisma ORM, Redis 6+
- File storage: MinIO/S3, Sharp (image processing)
- Search: Elasticsearch (optional, for full‑text search)
- Message queue: Redis Pub/Sub, Bull Queue
- Deployment: Docker, Docker Compose, Nginx, load balancing

**Diagram** – `docs/architecture/togaf/technology-architecture.puml`

## ADM Core Flow

ADM is TOGAF’s architecture development method, with 9 phases (simplified view):

### Phase A – Architecture Vision

- Define architecture scope, goals, and stakeholders
- Identify business drivers and high‑level requirements

### Phase B – Business Architecture

- Establish baseline business architecture
- Develop target business architecture
- Identify gaps in the business architecture

### Phase C – Information Systems Architecture

- Data architecture (C1): data entities, relationships, and flows
- Application architecture (C2): application components, interfaces, interactions

### Phase D – Technology Architecture

- Define technology platforms
- Identify technology standards and guidelines
- Create the technology architecture blueprint

### Phase E – Opportunities and Solutions

- Identify implementation opportunities
- Develop the implementation roadmap
- Assess risks and dependencies

### Phase F – Migration Planning

- Create detailed migration plan
- Define transition architectures
- Prepare implementation schedule

### Phase G – Implementation Governance

- Oversee architecture implementation
- Ensure conformance to architecture standards
- Manage architecture change requests

### Phase H – Architecture Change Management

- Manage architecture changes
- Maintain architecture continuity
- Assess needs for architecture evolution

### Requirements Management

- Continuous activity across all phases
- Manage requirement changes and traceability

## Architecture Principles

### 1. Business Principles

- **Business‑driven** – business needs drive architecture decisions
- **Information as an asset** – data is an enterprise asset and must be governed
- **Technology‑agnostic** – business architecture is independent of technology choices

### 2. Application Principles

- **Componentization** – applications are composed of reusable components
- **Standardized interfaces** – components communicate through standardized interfaces
- **Service orientation** – adopt service‑oriented architecture where appropriate

### 3. Data Principles

- **Data sharing** – data is shared across applications to avoid duplication
- **Data security** – data access is controlled and secure
- **Data quality** – data must be accurate, complete, and timely

### 4. Technology Principles

- **Technology standardization** – use industry standards to reduce technical debt
- **Platform‑first** – build reusable technical platforms
- **Scalability** – technology architecture must support business growth

## Architecture Artifacts

### Baseline Architecture

- Describes the current state of the architecture
- Used as a reference point for comparison

### Target Architecture

- Describes the desired future state
- Meets business and technology goals

### Gap Analysis

- Identifies gaps between baseline and target architectures
- Defines solutions to close the gaps

### Transition Architecture

- Defines intermediate states between baseline and target
- Supports phased implementation

## Project Mapping

### Architecture Documents

```text
docs/architecture/togaf/
├── overview.puml                  # Overall architecture overview
├── business-architecture.puml     # Business architecture
├── application-architecture.puml  # Application architecture
├── data-architecture.puml         # Data architecture
└── technology-architecture.puml   # Technology architecture
```

### Code Structure Mapping

**Business architecture** → business requirements and capability definitions

**Application architecture** →

- `apps/web/` – Web app (app, domain, application, infrastructure, presentation)
- `apps/mobile/` – mobile app (same layered structure)
- `apps/server/` – backend services (domain, application, infrastructure, presentation)

**Data architecture** →

- `apps/server/prisma/` – schema and migrations
- `apps/server/src/` – data access and caching logic

**Technology architecture** →

- Each app’s `package.json`, `tsconfig.json`
- Root `turbo.json`, `pnpm-workspace.yaml`

## Architecture Governance Rules

### Architecture Review

- Perform architecture impact analysis before new feature development
- Require architecture review for significant changes
- Keep architecture documents and code in sync

### Dependency Management

```text
Business Architecture → Application Architecture → Data Architecture → Technology Architecture
```

- Higher‑level architectures depend on lower‑level ones
- Changes in lower layers must be evaluated for impact on upper layers
- Reverse dependencies are forbidden

### Documentation Maintenance

- Update architecture diagrams when architecture changes
- Keep architecture documents aligned with implementation
- Review alignment periodically

## Checklists

### New Feature Development

- [ ] Identify which architecture domain(s) the feature belongs to
- [ ] Assess impact on existing architecture
- [ ] Ensure conformance to architecture principles
- [ ] Update related architecture documentation

### Architecture Change

- [ ] Identify impacted architecture domains
- [ ] Perform gap analysis
- [ ] Define transition approach
- [ ] Update diagrams and documents
- [ ] Notify relevant stakeholders

### Architecture Alignment

- [ ] Implementation matches architecture design
- [ ] Documentation reflects actual system state
- [ ] Dependency rules are followed
- [ ] Architecture principles are satisfied

## References

- [TOGAF official documentation](https://www.opengroup.org/togaf)
- [Project TOGAF diagrams](../../docs/architecture/togaf/README.md)
- [Architecture overview diagram](../../docs/architecture/togaf/overview.puml)
